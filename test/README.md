# API Crawler Test Directory

This directory contains test files, examples, and scripts for validating the API Crawler functionality.

## Contents

### Test Output Files
- `*.json` - Sample output files in different formats
- `demo_hierarchical_output.json` - Demonstration of hierarchical output structure
- `tree_test*.json` - Tree format test outputs
- `*_example_*.json` - Files generated by example scripts

### Test Scripts
- `run_format_tests.sh` - Comprehensive test script for all output formats

## Running Tests

### Quick Format Test
Run the comprehensive format test script:
```bash
./test/run_format_tests.sh
```

This script will:
- Test all output formats (standard, compact, hierarchical, tree)
- Test multiple URLs including edge cases
- Generate file size comparisons
- Create a summary report

### Manual Testing
Test individual formats manually:

```bash
# Standard format
./target/release/api_crawler https://httpbin.org/json -o test/manual_standard.json

# Hierarchical format  
./target/release/api_crawler https://httpbin.org/json --hierarchical -o test/manual_hierarchical.json

# Tree format (recommended)
./target/release/api_crawler https://httpbin.org/json --format tree -o test/manual_tree.json

# Compact format
./target/release/api_crawler https://httpbin.org/json --format compact -o test/manual_compact.json
```

### Example Scripts
Run the provided examples which also generate test files:

```bash
# Hierarchical output example
cargo run --example hierarchical_output

# Tree output example  
cargo run --example tree_output

# Simple test example
cargo run --example simple_test
```

## Test File Naming Convention

- `{source}_{format}.json` - Format-specific outputs
- `{feature}_example_{format}.json` - Example script outputs
- `tree_test*.json` - Manual tree format tests
- `demo_*.json` - Demonstration files

## Expected Results

### File Size Comparison
Typical file size reductions:
- **Tree format**: 50-70% smaller than standard
- **Hierarchical format**: 30-50% smaller than standard  
- **Compact format**: 60-80% smaller than standard (unreadable)

### Format Characteristics

| Format | Readability | File Size | Structure | Best For |
|--------|-------------|-----------|-----------|----------|
| Standard | Good | Large | Flat | General processing |
| Compact | Poor | Smallest | Flat | Data transmission |
| Hierarchical | Very Good | Medium | Grouped | Analysis |
| **Tree** | **Excellent** | **Small** | **Nested** | **Documentation** |

## Troubleshooting

### Common Issues

1. **Permission Denied**
   ```bash
   chmod +x test/run_format_tests.sh
   ```

2. **Network Timeouts**
   ```bash
   # Increase timeout for slow networks
   ./target/release/api_crawler URL --timeout 60
   ```

3. **Tree Format Panics**
   ```bash
   # Use debug mode for troubleshooting
   ./target/release/api_crawler URL --format tree --debug
   ```

4. **Large APIs**
   ```bash
   # Limit scope for very large APIs
   ./target/release/api_crawler URL --max-depth 3 --max-urls 100
   ```

### Debug Commands

```bash
# Verbose logging
./target/release/api_crawler URL --verbose

# Debug mode with fallbacks
./target/release/api_crawler URL --debug --format tree

# Conservative settings
./target/release/api_crawler URL --concurrency 1 --delay 1000 --max-depth 2
```

## Cleaning Up

Remove all test files:
```bash
rm test/*.json
```

Keep only essential files:
```bash
find test -name "*.json" -not -name "demo_*" -delete
```

## Contributing

When adding new tests:
1. Use descriptive filenames following the naming convention
2. Include both successful and edge case scenarios  
3. Update this README with new test descriptions
4. Ensure tests work with the provided script

## Test URLs

Safe public APIs for testing:
- `https://jsonplaceholder.typicode.com/posts/1` - Simple JSON response
- `https://httpbin.org/json` - Test JSON data
- `https://httpbin.org/html` - Non-JSON response (for error testing)
- `https://api.github.com` - Real HAL-style API (rate limited)

Avoid using:
- Internal company APIs in public tests
- APIs requiring authentication
- APIs with strict rate limiting
- Non-HTTPS endpoints in examples